# AT-006 Agent Lifecycle and Message Bus Tools

Implemented:
- `team_spawn`: creates worker agents within team thread limits and preserves inherited model behavior
- `team_spawn_ready_roles`: spawns only roles demanded by currently ready DAG tasks (`required_role` hints)
- Optional policy-driven model routing scaffold (role map/default route) that is disabled by default
- Optional per-role/default permission profile metadata assignment at spawn time
- `team_send`: direct message bus send with idempotency key handling
- `team_broadcast`: one publish operation fan-out to team peers via inbox routing
- `team_pull_inbox`: inbox retrieval with optional acknowledgement
- Duplicate suppression for repeated payloads inside a short window (even with different idempotency keys)
- Delta artifact-ref messaging for repeated summaries (only newly added refs are sent)

Acceptance notes:
- Message delivery is at-least-once with idempotency keys (`team_id + idempotency_key`)
- Default payload shape uses compact summaries + artifact references (no full transcript exchange)
- Explicit model input on `team_spawn` always takes precedence over policy/default inheritance
- When `model_routing.enabled=false` (current shipped profiles), spawn behavior remains unchanged (`session_model` inheritance)
- `team_spawn_ready_roles` will not pre-spawn static roles; it only spawns unique, hinted roles from ready tasks
- Broadcast and inbox pull/ack path is validated in integration tests with structured tool-call logs
- Duplicate suppression and delta messaging reduce redundant message bus traffic
